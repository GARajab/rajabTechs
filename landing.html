<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Console Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Unique concept: Neon Glass Dashboard with motion and depth */
        :root{
            --bg-1: #081229; /* deep navy */
            --accent-1: #7C5CFE; /* purple */
            --accent-2: #00E6A8; /* mint */
            --accent-3: #FF6B6B; /* coral */
            --text: #EAF6FF; /* bright text for high contrast */
            --muted: rgba(234,246,255,0.78);
            --glass: rgba(255,255,255,0.04);
            --glass-2: rgba(255,255,255,0.02);
            --soft-shadow: 0 10px 40px rgba(2,6,23,0.7);
        }

        *{box-sizing:border-box;margin:0;padding:0;font-family: 'Poppins', Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}

        html,body{height:100%}
        body{
            background: radial-gradient(1200px 600px at 10% 10%, rgba(124,92,254,0.18), transparent 6%),
                        radial-gradient(800px 400px at 90% 80%, rgba(0,230,168,0.12), transparent 6%),
                        linear-gradient(180deg,var(--bg-1) 0%, #051126 100%);
            color:var(--text);
            min-height:100vh;
            padding:28px;
            -webkit-font-smoothing:antialiased;
            overflow-x:hidden;
        }

        /* floating blobs for motion */
        body::before, body::after{
            content:''; position:fixed; z-index:0; filter:blur(60px); opacity:0.9; pointer-events:none;
        }
        body::before{ width:520px; height:520px; left:-120px; top:-80px; background:linear-gradient(120deg,var(--accent-1), rgba(124,92,254,0.25)); animation:floatA 12s ease-in-out infinite }
        body::after{ width:420px; height:420px; right:-80px; bottom:-80px; background:linear-gradient(120deg,var(--accent-2), rgba(0,230,168,0.18)); animation:floatB 14s ease-in-out infinite }

        @keyframes floatA{ 0%{transform:translateY(0) rotate(0)}50%{transform:translateY(18px) rotate(4deg)}100%{transform:translateY(0) rotate(0)} }
        @keyframes floatB{ 0%{transform:translateY(0) rotate(0)}50%{transform:translateY(-14px) rotate(-4deg)}100%{transform:translateY(0) rotate(0)} }

        .container{
            position:relative; z-index:2; max-width:1200px; margin:0 auto; padding:28px; border-radius:16px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.04); box-shadow: var(--soft-shadow);
        }

        header{ display:flex; align-items:center; justify-content:space-between; gap:20px; margin-bottom:22px }
        .logo{ display:flex; align-items:center; gap:12px }
        .logo i{ font-size:28px; color:var(--accent-1); background:linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); padding:8px; border-radius:10px }
        .logo h1{ color:#fff; font-weight:700; letter-spacing:0.2px; font-size:20px }

        /* neon pill buttons */
        .user-actions{ display:flex; gap:12px }
        .btn{ padding:8px 14px; border-radius:999px; border:1px solid rgba(255,255,255,0.06); color:#eaf6ff; background:transparent; cursor:pointer; display:inline-flex; gap:8px; align-items:center }
        .btn-primary{ background:linear-gradient(90deg,var(--accent-1),var(--accent-2)); color:#021020; font-weight:700; box-shadow:0 6px 30px rgba(124,92,254,0.12), 0 2px 10px rgba(0,230,168,0.06); transform:translateZ(0) }
        .btn-primary:active{ transform:translateY(1px) }
        .btn-secondary{ background:transparent; border:1px solid rgba(255,255,255,0.06) }

        /* dashboard grid with layered depth */
        .dashboard{ display:grid; grid-template-columns: repeat(3, 1fr); gap:20px }
        @media(max-width:980px){ .dashboard{ grid-template-columns: repeat(2, 1fr) } }
        @media(max-width:640px){ .dashboard{ grid-template-columns: 1fr } }

        /* glass card with neon outline and 3D tilt */
        .card{ position:relative; overflow:visible; border-radius:14px; padding:18px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.04); backdrop-filter: blur(8px); transition: transform .22s cubic-bezier(.2,.9,.2,1), box-shadow .22s; transform-style:preserve-3d }
        /* subtle inner glow (shown on hover) */
        .card::after{ content:''; position:absolute; inset:-2px; z-index:-1; border-radius:inherit; padding:2px; background:linear-gradient(90deg, rgba(124,92,254,0.08), rgba(0,230,168,0.05)); filter:blur(14px); opacity:0; transition:opacity .28s, transform .28s }
        .card:hover::after{ opacity:1; transform:scale(1.03); }
        /* animated gradient glow ring behind the card (stronger on hover) */
        .card::before{ content:''; position:absolute; inset:-3px; z-index:-2; border-radius:inherit; padding:2px; background: linear-gradient(60deg, rgba(124,92,254,0.28), rgba(0,230,168,0.22), rgba(255,107,107,0.16)); filter:blur(22px); opacity:0; transform:scale(.98); transition:opacity .28s, transform .28s }
        .card:hover::before{ opacity:1; transform:scale(1.02); }

        .card-header{ display:flex; align-items:center; justify-content:space-between; margin-bottom:14px }
        .card-title{ color:var(--text); font-weight:800; font-size:1.05rem }
        .card-icon{ width:48px; height:48px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:18px; color:#fff; box-shadow: 0 6px 18px rgba(124,92,254,0.12); transition: box-shadow .22s, transform .18s }
        .card:hover .card-icon{ transform: translateY(-4px) scale(1.06); box-shadow: 0 26px 70px rgba(124,92,254,0.22) }

        .options{ display:flex; flex-direction:column; gap:10px }
        .option{ position:relative; display:flex; align-items:center; gap:12px; padding:12px; border-radius:10px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.00)); border:1px solid rgba(255,255,255,0.04); cursor:pointer; transition: transform .18s, box-shadow .18s }
        .option:hover{ transform:translateY(-6px); box-shadow: 0 28px 70px rgba(2,6,23,0.68); }
        .option::after{ content:''; position:absolute; pointer-events:none; inset:0; border-radius:10px; box-shadow: 0 0 0 2px rgba(124,92,254,0.06) inset; opacity:0; transition:opacity .22s }
        .option:hover::after{ opacity:1 }
        .option-title { color: var(--text); font-weight:700 }
        .option-desc { color: var(--muted); font-size:0.92rem }

    .status-item{ display:flex; align-items:center; justify-content:space-between; padding:10px 0; border-bottom:1px dashed rgba(255,255,255,0.02) }
    .status-badge{ padding:6px 12px; border-radius:999px; font-weight:700; color:#021020; background:linear-gradient(90deg, #fff, #fff) }
    .status-upcoming{ background: linear-gradient(90deg, rgba(255,149,0,0.95), rgba(255,107,107,0.95)); color:#021020 }
    .status-released{ background: linear-gradient(90deg, rgba(52,199,89,0.95), rgba(0,200,140,0.95)); color:#021020 }
    .status-delayed{ background: linear-gradient(90deg, rgba(164,80,255,0.95), rgba(255,107,107,0.85)); color:#021020 }

        .fw-info{ display:flex; align-items:center; justify-content:space-between; padding:8px 0 }

    .serial-checker{ display:flex; gap:10px; margin-top:12px }
    .serial-input{ flex:1; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,0.06); background:rgba(2,6,23,0.55); color:var(--text) }
    .serial-input::placeholder{ color:rgba(234,246,255,0.45) }

    .admin-panel{ margin-top:18px; border-radius:12px; padding:16px; display:none; border:1px solid rgba(255,255,255,0.04); background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); }
    .admin-panel.show{ display:block; animation:popIn .22s ease-out }

    /* Admin form layout improvements */
    .admin-form{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; align-items:start }
    .admin-form .form-group{ display:flex; flex-direction:column; gap:6px }
    .admin-form .form-label{ color:var(--muted); font-weight:600 }
    .admin-form .form-input{ width:100%; padding:10px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:rgba(255,255,255,0.01); color:var(--text) }
    .admin-actions{ display:flex; gap:12px; margin-top:12px }
    @media(max-width:700px){ .admin-form{ grid-template-columns:1fr } }

    /* icon accents: keep glass backgrounds but color the icon glyph to match content */
    .card-icon, .option-icon{ display:flex; align-items:center; justify-content:center; min-width:44px; background: rgba(255,255,255,0.02); border-radius:8px; padding:6px; border:1px solid rgba(255,255,255,0.03) }

    /* Icon glyph colors (accent the icon only, not the whole block) */
    .ps4-bg i, .ps4-bg .fa { color: #0063C6 !important; filter: drop-shadow(0 6px 18px rgba(0,99,198,0.08)); }
    .ps5-bg i, .ps5-bg .fa { color: #8A2BE2 !important; filter: drop-shadow(0 6px 18px rgba(138,43,226,0.08)); }
    .userland-bg i, .userland-bg .fa { color: #34C759 !important; filter: drop-shadow(0 6px 18px rgba(52,199,89,0.06)); }
    .kernel-bg i, .kernel-bg .fa { color: #FF9500 !important; filter: drop-shadow(0 6px 18px rgba(255,149,0,0.06)); }
    .status-bg i, .status-bg .fa { color: #007AFF !important; filter: drop-shadow(0 6px 18px rgba(0,122,255,0.08)); }
    .fw-bg i, .fw-bg .fa { color: #9099A1 !important; filter: drop-shadow(0 6px 18px rgba(144,153,161,0.05)); }

    /* subtle border tint when an icon block is present */
    .ps4-bg, .ps5-bg, .userland-bg, .kernel-bg, .status-bg, .fw-bg { background: rgba(255,255,255,0.01); border:1px solid rgba(255,255,255,0.02) }

    /* Hover emphasis: stronger glow ring and lift for cards and options */
    .card:hover { transform: translateY(-8px) scale(1.006); box-shadow: 0 34px 90px rgba(2,6,23,0.72); }
    .card:hover .card-icon{ transform: translateY(-4px) scale(1.06); box-shadow: 0 26px 70px rgba(124,92,254,0.22) }

    .option{ position:relative }
    .option:hover{ box-shadow: 0 28px 70px rgba(2,6,23,0.68) }
    .option::after{ content:''; position:absolute; pointer-events:none; inset:0; border-radius:10px; box-shadow: 0 0 0 2px rgba(124,92,254,0.06) inset; opacity:0; transition:opacity .22s }
    .option:hover::after{ opacity:1 }

    /* small icon glow on hover of its parent card/option */
    .card:hover .ps4-bg i, .option:hover .ps4-bg i { filter: drop-shadow(0 14px 32px rgba(0,99,198,0.12)) }
    .card:hover .ps5-bg i, .option:hover .ps5-bg i { filter: drop-shadow(0 14px 32px rgba(138,43,226,0.12)) }
    .card:hover .userland-bg i, .option:hover .userland-bg i { filter: drop-shadow(0 14px 32px rgba(52,199,89,0.10)) }
    .card:hover .kernel-bg i, .option:hover .kernel-bg i { filter: drop-shadow(0 14px 32px rgba(255,149,0,0.10)) }

        @keyframes popIn{ from{ transform:translateY(-6px) scale(.995); opacity:0 } to{ transform:none; opacity:1 } }

        /* Theme installer styles */
    .theme-installer { padding: 15px 0 }
    .install-methods { display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px }
    .install-methods .option { padding: 12px; display: flex; align-items: center; gap: 12px }
    .install-methods .btn { margin-left: auto }
    
    .theme-dropzone {
        border: 2px dashed rgba(124,92,254,0.3);
        border-radius: 12px;
        padding: 25px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s;
        background: rgba(255,255,255,0.02);
    }
    .theme-dropzone:hover, .theme-dropzone.drag-active {
        border-color: var(--accent-1);
        background: rgba(124,92,254,0.06);
    }
    .theme-dropzone i {
        font-size: 32px;
        color: var(--accent-1);
        margin-bottom: 10px;
    }
    .theme-dropzone p {
        color: var(--muted);
        margin: 0;
    }
    
    .install-progress {
        margin-top: 15px;
        padding: 10px;
        border-radius: 8px;
        background: rgba(255,255,255,0.02);
    }
    .progress-bar {
        height: 4px;
        background: rgba(255,255,255,0.1);
        border-radius: 2px;
        overflow: hidden;
    }
    .progress-fill {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, var(--accent-1), var(--accent-2));
        transition: width 0.3s;
    }
    .progress-text {
        margin: 8px 0 0;
        font-size: 14px;
        color: var(--muted);
        text-align: center;
    }
    
    /* notification popup (neon toast) */
    #notificationContainer{ position:fixed; right:24px; bottom:24px; z-index:10000; display:flex; flex-direction:column; gap:12px; align-items:flex-end }
    .ntf { min-width:260px; max-width:420px; background:linear-gradient(90deg, rgba(255,255,255,0.98), rgba(250,250,250,0.98)); color:#081229; padding:12px 14px; border-radius:12px; box-shadow: 0 12px 40px rgba(2,6,23,0.6); border:1px solid rgba(124,92,254,0.08); display:flex; gap:10px; align-items:flex-start; transform-origin:100% 100%; overflow:hidden }
    .ntf .icon{ width:38px; height:38px; display:flex; align-items:center; justify-content:center; border-radius:8px; font-size:16px }
    .ntf .body{ flex:1 }
    .ntf h4{ margin:0 0 4px 0; font-size:14px; font-weight:700 }
    .ntf p{ margin:0; font-size:13px; color:#2e2e2e }
    .ntf.success{ border-left:4px solid #19a974 }
    .ntf.error{ border-left:4px solid #ff4d4f }
    .ntf.info{ border-left:4px solid #7c5cfe }
    @keyframes ntfIn{ from{ opacity:0; transform:translateY(10px) scale(.98) } to{ opacity:1; transform:none } }
    @keyframes ntfOut{ from{ opacity:1; transform:none } to{ opacity:0; transform:translateY(10px) scale(.98) } }
    .ntf.show{ animation: ntfIn .28s cubic-bezier(.2,.9,.2,1) forwards }
    .ntf.hide{ animation: ntfOut .28s cubic-bezier(.2,.9,.2,1) forwards }

    /* small helpers */
    .toggle-admin{ margin-top:16px; text-align:center }
    .toggle-btn{ color:var(--accent-2); background:transparent; border:none; cursor:pointer; font-weight:600 }

        /* tiny decorative footer inside container */
        .container-footer{ margin-top:18px; text-align:center; color:rgba(255,255,255,0.38); font-size:13px }

    /* Admin auth modal (simple client-side gate) */
    .auth-modal{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(2,6,23,0.6); z-index:9999; visibility:hidden; opacity:0; transition:opacity .18s, visibility .18s }
    .auth-modal.show{ visibility:visible; opacity:1 }
    /* modal card: match index page card design (light card with subtle shadow) */
    .auth-modal .auth-card{ width:360px; background: #ffffff; color: #1c1c1e; border:1px solid #E5E5E5; padding:18px; border-radius:12px; box-shadow: 0 8px 30px rgba(0,0,0,0.12); }
    .auth-modal .auth-card h3{ margin-bottom:8px; color:#1c1c1e }
    .auth-modal .auth-input{ width:100%; padding:10px 12px; border-radius:8px; border:1px solid #CED4DA; background:#fff; color:#1c1c1e; margin-bottom:12px }
    .auth-actions{ display:flex; gap:8px; justify-content:flex-end }

    /* blur the main content while auth modal is active to focus attention (applied via body.auth-active) */
    body.auth-active > .container,
    body.auth-active .toggle-admin,
    body.auth-active footer,
    body.auth-active .container-footer {
        filter: blur(6px) brightness(.85);
        pointer-events: none;
        user-select: none;
        transition: filter .18s;
    }

    /* change-password card style to match index page white cards */
    .change-password-card{ background:#fff; color:#1c1c1e; border-radius:10px; padding:16px; border:1px solid #E5E5E5; box-shadow: 0 8px 24px rgba(0,0,0,0.08); margin-top:12px; border-left:6px solid rgba(124,92,254,0.12) }
    .change-password-card h3{ margin:0 0 8px 0; font-size:1rem; color:#1c1c1e; padding-left:6px }
    .change-password-card .form-input{ background:#fff; color:#1c1c1e; border:1px solid #CED4DA }
    .change-password-actions{ display:flex; gap:8px; align-items:center }
    /* password strength meter */
    .pw-meter{ height:8px; background:#F0F0F0; border-radius:6px; overflow:hidden; margin-top:6px }
    .pw-meter .pw-bar{ height:100%; width:0%; background:linear-gradient(90deg,#FF6B6B,#7C5CFE); transition:width .18s }
    .pw-strength-label{ font-size:12px; color:#6c757d; margin-top:6px }

    @media(max-width:700px){
        #cp_grid{ grid-template-columns: 1fr !important; }
        .change-password-card{ padding:12px }
    }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-gamepad"></i>
                <h1>Console Wizard Dashboard</h1>
            </div>
            <div class="user-actions">
                <button class="btn btn-secondary">
                    <i class="fas fa-user"></i> Profile
                </button>
                <button class="btn btn-primary">
                    <i class="fas fa-cog"></i> Settings
                </button>
            </div>
        </header>
        
        <div class="dashboard">
            <!-- PS4 Games Card -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">PS4 Games</h2>
                    <div class="card-icon ps4-bg">
                        <i class="fab fa-playstation"></i>
                    </div>
                </div>
                <div class="options">
                    <div class="option">
                        <div class="option-icon ps4-bg">
                            <i class="fas fa-magic"></i>
                        </div>
                        <div class="option-text">
                            <div class="option-title">Userland Wizard</div>
                            <div class="option-desc">PS4 userland exploits and tools</div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="option">
                        <div class="option-icon kernel-bg">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <div class="option-text">
                            <div class="option-title">Kernel Wizard</div>
                            <div class="option-desc">PS4 kernel exploits and tools</div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="option">
                        <div class="option-icon userland-bg">
                            <i class="fas fa-wand-magic-sparkles"></i>
                        </div>
                        <div class="option-text">
                            <div class="option-title">Both Userland & Kernel</div>
                            <div class="option-desc">Complete PS4 exploitation suite</div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                </div>
            </div>
            
            <!-- PS5 Games Card -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">PS5 Games</h2>
                    <div class="card-icon ps5-bg">
                        <i class="fab fa-playstation"></i>
                    </div>
                </div>
                <div class="options">
                    <div class="option">
                        <div class="option-icon ps5-bg">
                            <i class="fas fa-magic"></i>
                        </div>
                        <div class="option-text">
                            <div class="option-title">Userland Wizard</div>
                            <div class="option-desc">PS5 userland exploits and tools</div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="option">
                        <div class="option-icon kernel-bg">
                            <i class="fas fa-cogs"></i>
                        </div>
                        <div class="option-text">
                            <div class="option-title">Kernel Wizard</div>
                            <div class="option-desc">PS5 kernel exploits and tools</div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                    <div class="option">
                        <div class="option-icon userland-bg">
                            <i class="fas fa-wand-magic-sparkles"></i>
                        </div>
                        <div class="option-text">
                            <div class="option-title">Both Userland & Kernel</div>
                            <div class="option-desc">Complete PS5 exploitation suite</div>
                        </div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                </div>
            </div>
            
            <!-- Jailbreak Status Card -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Jailbreak Status</h2>
                    <div class="card-icon status-bg">
                        <i class="fas fa-chart-line"></i>
                    </div>
                </div>
                <div class="status-list">
                    <div class="status-item">
                        <div class="status-name">
                            <i class="fas fa-bug"></i>
                            <span>Y2JB</span>
                        </div>
                        <div id="y2jb_badge" class="status-badge status-upcoming">Upcoming</div>
                    </div>
                    <div class="status-item">
                        <div id="y2jb_date_display" class="status-date">Expected: Q4 2023</div>
                    </div>
                    <div class="status-item">
                        <div class="status-name">
                            <i class="fas fa-film"></i>
                            <span>Netflix-N-Hack</span>
                        </div>
                        <div id="net_badge" class="status-badge status-upcoming">Upcoming</div>
                    </div>
                    <div class="status-item">
                        <div id="net_date_display" class="status-date">Expected: Q1 2024</div>
                    </div>
                </div>
            </div>
            
            <!-- Firmware Info Card -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Latest Firmware</h2>
                    <div class="card-icon fw-bg">
                        <i class="fas fa-microchip"></i>
                    </div>
                </div>
                <div class="fw-list">
                    <div class="fw-info">
                        <div class="fw-platform">
                            <i class="fab fa-playstation ps4-bg" style="padding: 8px; border-radius: 6px;"></i>
                                <span>PS4</span>
                            </div>
                            <div id="ps4_fw_display" class="fw-version">13.02</div>
                    </div>
                    <div class="fw-info">
                            <div id="ps4_date_display" class="fw-date">Released: 2023-08-15</div>
                    </div>
                    <div class="fw-info">
                        <div class="fw-platform">
                            <i class="fab fa-playstation ps5-bg" style="padding: 8px; border-radius: 6px;"></i>
                                <span>PS5</span>
                            </div>
                            <div id="ps5_fw_display" class="fw-version">12.02</div>
                    </div>
                    <div class="fw-info">
                            <div id="ps5_date_display" class="fw-date">Released: 2023-09-05</div>
                    </div>
                </div>
            </div>
            
            <!-- Serial Number Checker -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Serial Number Checker</h2>
                    <div class="card-icon ps5-bg">
                        <i class="fas fa-search"></i>
                    </div>
                </div>
                <p>Check your PS5 firmware version by serial number</p>
                <div class="serial-checker">
                    <input type="text" class="serial-input" placeholder="Enter PS5 serial number">
                    <button id="serialCheckBtn" class="btn btn-primary">Check</button>
                </div>
            </div>

            <!-- Theme Installer -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Theme Installer</h2>
                    <div class="card-icon ps4-bg">
                        <i class="fas fa-paint-brush"></i>
                    </div>
                </div>
                <div class="theme-installer">
                    <div class="install-methods">
                        <div class="option">
                            <div class="option-icon ps4-bg">
                                <i class="fas fa-network-wired"></i>
                            </div>
                            <div class="option-text">
                                <div class="option-title">FTP Install</div>
                                <div class="option-desc">Transfer theme via FTP connection</div>
                            </div>
                            <button class="btn btn-secondary" id="ftpInstallBtn">
                                <i class="fas fa-upload"></i> Install via FTP
                            </button>
                        </div>
                        <div class="option">
                            <div class="option-icon ps4-bg">
                                <i class="fas fa-memory"></i>
                            </div>
                            <div class="option-text">
                                <div class="option-title">Binloader Install</div>
                                <div class="option-desc">Install theme using binloader</div>
                            </div>
                            <button class="btn btn-secondary" id="binInstallBtn">
                                <i class="fas fa-code"></i> Use Binloader
                            </button>
                        </div>
                    </div>
                    <div id="themeDropzone" class="theme-dropzone">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Drag & drop .pkg theme file here or click to browse</p>
                        <input type="file" id="themeFileInput" accept=".pkg" style="display:none">
                    </div>
                    <div id="installProgress" class="install-progress" style="display:none">
                        <div class="progress-bar"><div class="progress-fill"></div></div>
                        <p class="progress-text">Installing theme...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Admin Panel -->
        <div class="admin-panel" id="adminPanel">
            <div class="admin-header">
                <h2 class="admin-title">Admin Dashboard</h2>
                <div class="card-icon ps5-bg">
                    <i class="fas fa-lock"></i>
                </div>
                <button id="adminLockBtn" class="btn btn-secondary" style="margin-left:10px; display:none">
                    <i class="fas fa-lock-open"></i>
                    Lock
                </button>
            </div>
            
                <div class="admin-form">
                    <div class="form-group">
                        <label class="form-label">PS4 Latest Firmware</label>
                        <input id="ps4_fw_input" type="text" class="form-input" value="13.02">
                    </div>

                    <div class="form-group">
                        <label class="form-label">PS4 Release Date</label>
                        <input id="ps4_date_input" type="text" class="form-input" value="2023-08-15">
                    </div>

                    <div class="form-group">
                        <label class="form-label">PS5 Latest Firmware</label>
                        <input id="ps5_fw_input" type="text" class="form-input" value="12.02">
                    </div>

                    <div class="form-group">
                        <label class="form-label">PS5 Release Date</label>
                        <input id="ps5_date_input" type="text" class="form-input" value="2023-09-05">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Y2JB Status</label>
                        <select id="y2jb_status" class="form-input">
                            <option value="Upcoming">Upcoming</option>
                            <option value="Released">Released</option>
                            <option value="Delayed">Delayed</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Y2JB Expected Date</label>
                        <input id="y2jb_date" type="text" class="form-input" value="Q4 2023">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Netflix-N-Hack Status</label>
                        <select id="net_status" class="form-input">
                            <option value="Upcoming">Upcoming</option>
                            <option value="Released">Released</option>
                            <option value="Delayed">Delayed</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Netflix-N-Hack Expected Date</label>
                        <input id="net_date" type="text" class="form-input" value="Q1 2024">
                    </div>
                </div>
            
            <div class="admin-actions">
                <button id="adminSaveBtn" class="btn btn-primary">
                    <i class="fas fa-save"></i> Save Changes
                </button>
                <button id="adminResetBtn" class="btn btn-secondary">
                    <i class="fas fa-sync"></i> Reset to Default
                </button>
                <button id="cpToggleBtn" class="btn btn-secondary" style="margin-left:8px">
                    <i class="fas fa-key"></i> Edit Password
                </button>
            </div>
            
            <!-- Change password section (styled like index page cards) -->
            <div id="changePasswordContainer" class="change-password-card" style="display:none">
                <h3>Change Admin Password</h3>
                <div id="cp_grid" style="display:grid; grid-template-columns:1fr 1fr; gap:8px; align-items:start">
                    <input id="cp_current" type="password" class="form-input" placeholder="Current password">
                    <input id="cp_new" type="password" class="form-input" placeholder="New password (min 6)">
                    <input id="cp_confirm" type="password" class="form-input" placeholder="Confirm new password">
                    <div style="grid-column:1 / -1">
                        <div class="pw-meter" aria-hidden="true"><div id="pwBar" class="pw-bar"></div></div>
                        <div id="pwLabel" class="pw-strength-label">Password strength: <span id="pwVerdict">—</span></div>
                    </div>
                    <div class="change-password-actions">
                        <button id="cp_btn" class="btn btn-primary" style="width:120px"><i class="fas fa-key"></i> Change</button>
                        <div id="cp_msg" style="color:#ffb3b3; font-size:13px; min-height:18px"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="toggle-admin">
            <button class="toggle-btn" id="toggleAdmin">Toggle Admin Panel</button>
        </div>
    </div>

    <!-- Admin Auth Modal -->
    <div id="adminAuthModal" class="auth-modal" aria-hidden="true">
        <div class="auth-card" role="dialog" aria-modal="true" aria-labelledby="authTitle">
            <h3 id="authTitle">Admin Authentication</h3>
            <p id="authDesc" style="color:var(--muted); margin-bottom:10px;">Enter the admin password to access the panel.</p>
            <input id="admin_password" class="auth-input" type="password" placeholder="Admin password" />
            <input id="admin_password_confirm" class="auth-input" type="password" placeholder="Confirm password" style="display:none" />
            <input id="admin_setup_token" class="auth-input" type="text" placeholder="Setup code (required for first run)" style="display:none" />
            <div style="color:#ffb3b3; min-height:18px; margin-bottom:6px; font-size:13px" id="authMessage"></div>
            <div class="auth-actions">
                <button id="adminCancelBtn" class="btn btn-secondary">Cancel</button>
                <button id="adminLoginBtn" class="btn btn-primary">Unlock</button>
            </div>
        </div>
    </div>
    
            <!-- Notification container -->
            <div id="notificationContainer" aria-live="polite" aria-atomic="true"></div>

            <script>
        // Enhanced interactions: admin toggle, serial check, and card tilt
        (function(){
            /* --- Admin data (persist to localStorage) --- */
            const ADMIN_KEY = 'rajabTechs_admin_v1';
            const defaults = {
                ps4_fw: '13.02', ps4_date: '2023-08-15',
                ps5_fw: '12.02', ps5_date: '2023-09-05',
                y2jb_status: 'Upcoming', y2jb_date: 'Q4 2023',
                net_status: 'Upcoming', net_date: 'Q1 2024'
            };

            function loadAdminData(){
                try{
                    const raw = localStorage.getItem(ADMIN_KEY);
                    return raw ? JSON.parse(raw) : {...defaults};
                }catch(e){ return {...defaults}; }
            }

            function saveAdminData(data){
                localStorage.setItem(ADMIN_KEY, JSON.stringify(data));
            }

            function updateFirmwareUI(data){
                const ps4fw = document.getElementById('ps4_fw_display');
                const ps5fw = document.getElementById('ps5_fw_display');
                const ps4date = document.getElementById('ps4_date_display');
                const ps5date = document.getElementById('ps5_date_display');
                if(ps4fw) ps4fw.textContent = data.ps4_fw || defaults.ps4_fw;
                if(ps5fw) ps5fw.textContent = data.ps5_fw || defaults.ps5_fw;
                if(ps4date) ps4date.textContent = 'Released: ' + (data.ps4_date || defaults.ps4_date);
                if(ps5date) ps5date.textContent = 'Released: ' + (data.ps5_date || defaults.ps5_date);
            }

            function updateStatusUI(data){
                // Y2JB
                const y2jbBadge = document.getElementById('y2jb_badge');
                const y2jbDate = document.getElementById('y2jb_date_display');
                if(y2jbBadge){
                    y2jbBadge.textContent = data.y2jb_status || defaults.y2jb_status;
                    y2jbBadge.classList.remove('status-upcoming','status-released','status-delayed');
                    const s = (data.y2jb_status || defaults.y2jb_status).toLowerCase();
                    if(s === 'released') y2jbBadge.classList.add('status-released');
                    else if(s === 'delayed') y2jbBadge.classList.add('status-delayed');
                    else y2jbBadge.classList.add('status-upcoming');
                }
                if(y2jbDate){ y2jbDate.textContent = 'Expected: ' + (data.y2jb_date || defaults.y2jb_date); }

                // Netflix-N-Hack
                const netBadge = document.getElementById('net_badge');
                const netDate = document.getElementById('net_date_display');
                if(netBadge){
                    netBadge.textContent = data.net_status || defaults.net_status;
                    netBadge.classList.remove('status-upcoming','status-released','status-delayed');
                    const s2 = (data.net_status || defaults.net_status).toLowerCase();
                    if(s2 === 'released') netBadge.classList.add('status-released');
                    else if(s2 === 'delayed') netBadge.classList.add('status-delayed');
                    else netBadge.classList.add('status-upcoming');
                }
                if(netDate){ netDate.textContent = 'Expected: ' + (data.net_date || defaults.net_date); }
            }

            function populateAdminForm(data){
                const map = {
                    ps4_fw_input: data.ps4_fw,
                    ps4_date_input: data.ps4_date,
                    ps5_fw_input: data.ps5_fw,
                    ps5_date_input: data.ps5_date,
                    y2jb_status: data.y2jb_status,
                    y2jb_date: data.y2jb_date,
                    net_status: data.net_status,
                    net_date: data.net_date
                };
                Object.keys(map).forEach(id=>{ const el = document.getElementById(id); if(el) el.value = map[id]; });
            }

            function readAdminForm(){
                return {
                    ps4_fw: document.getElementById('ps4_fw_input').value.trim() || defaults.ps4_fw,
                    ps4_date: document.getElementById('ps4_date_input').value.trim() || defaults.ps4_date,
                    ps5_fw: document.getElementById('ps5_fw_input').value.trim() || defaults.ps5_fw,
                    ps5_date: document.getElementById('ps5_date_input').value.trim() || defaults.ps5_date,
                    y2jb_status: document.getElementById('y2jb_status').value,
                    y2jb_date: document.getElementById('y2jb_date').value.trim() || defaults.y2jb_date,
                    net_status: document.getElementById('net_status').value,
                    net_date: document.getElementById('net_date').value.trim() || defaults.net_date
                };
            }

            // Initialize admin form and UI from storage/defaults
            const stored = loadAdminData();
            updateFirmwareUI(stored);
            updateStatusUI(stored);
            populateAdminForm(stored);
            // restore change-password unlocked state if within timeout
            try{
                const _cpContainer = document.getElementById('changePasswordContainer');
                const _cpToggle = document.getElementById('cpToggleBtn');
                if(isChangeUnlocked()){
                    if(_cpContainer) _cpContainer.style.display = 'block';
                    if(_cpToggle) _cpToggle.innerHTML = '<i class="fas fa-times"></i> Close';
                    // restart timer
                    startChangeUnlockTimer();
                } else {
                    if(_cpContainer) _cpContainer.style.display = 'none';
                }
            }catch(e){}
            // Admin toggle with a simple client-side auth modal
            const toggleBtn = document.getElementById('toggleAdmin');
            const adminPanel = document.getElementById('adminPanel');
            const adminAuthModal = document.getElementById('adminAuthModal');
            const adminLoginBtn = document.getElementById('adminLoginBtn');
            const adminCancelBtn = document.getElementById('adminCancelBtn');
            const adminLockBtn = document.getElementById('adminLockBtn');

            // NOTE: client-side protection — not cryptographically secure. Server-side auth is recommended.
            // Preferred flow: store the SHA-256 hex of the admin password in localStorage (first-run setup).
            // For backwards compatibility a base64-embedded secret may be present, but it's deprecated.
            const ADMIN_SECRET_B64 = 'MTk4NzE5ODc='; // (deprecated) base64 for 'admin123'
            const ADMIN_HASH_KEY = 'rajab_admin_hash_v1'; // localStorage key for stored SHA-256 hex
            const AUTH_KEY = 'rajab_admin_authed';

            function decodeSecret(b64){ try{ return atob(b64); }catch(e){return '';} }

            // helper: compute SHA-256 and return hex string
            async function sha256Hex(str){
                const enc = new TextEncoder();
                const data = enc.encode(str);
                const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                const hashArray = Array.from(new Uint8Array(hashBuffer));
                return hashArray.map(b => b.toString(16).padStart(2,'0')).join('');
            }

            function isAuthorized(){ return sessionStorage.getItem(AUTH_KEY) === '1'; }
            function setAuthorized(){ sessionStorage.setItem(AUTH_KEY, '1'); adminLockBtn.style.display = 'inline-flex'; }
            function clearAuthorized(){ sessionStorage.removeItem(AUTH_KEY); adminLockBtn.style.display = 'none'; adminPanel.classList.remove('show'); toggleBtn.textContent = 'Show Admin Panel';
                // also clear any change-password unlock and hide the change container
                try{ sessionStorage.removeItem('rajab_change_unlocked'); const _cp = document.getElementById('changePasswordContainer'); if(_cp) _cp.style.display = 'none'; const _cpb = document.getElementById('cpToggleBtn'); if(_cpb) _cpb.innerHTML = '<i class="fas fa-key"></i> Edit Password'; }catch(e){}
            }

            // modal modes: 'login' or 'setup'
            let authMode = 'login';

            function showAuthModal(){
                authMode = 'login';
                document.getElementById('authDesc').textContent = 'Enter the admin password to access the panel.';
                document.getElementById('admin_password_confirm').style.display = 'none';
                try{ document.getElementById('admin_setup_token').style.display = 'none'; }catch(e){}
                adminLoginBtn.textContent = 'Unlock';
                adminAuthModal.classList.add('show'); adminAuthModal.setAttribute('aria-hidden','false');
                document.body.classList.add('auth-active');
                document.getElementById('admin_password').value = '';
                document.getElementById('authMessage').textContent = '';
                document.getElementById('admin_password').focus();
            }

            function showSetupModal(){
                authMode = 'setup';
                document.getElementById('authDesc').textContent = 'Create an admin password (first run). Choose a strong password.';
                document.getElementById('admin_password_confirm').style.display = 'block';
                // require a setup token for first-run to prevent arbitrary users from becoming admin
                document.getElementById('admin_setup_token').style.display = 'block';
                adminLoginBtn.textContent = 'Set password';
                adminAuthModal.classList.add('show'); adminAuthModal.setAttribute('aria-hidden','false');
                document.body.classList.add('auth-active');
                document.getElementById('admin_password').value = '';
                document.getElementById('admin_password_confirm').value = '';
                document.getElementById('admin_setup_token').value = '';
                document.getElementById('authMessage').textContent = '';
                document.getElementById('admin_password').focus();
            }

            function hideAuthModal(){ adminAuthModal.classList.remove('show'); adminAuthModal.setAttribute('aria-hidden','true'); document.body.classList.remove('auth-active'); }

            // wire toggle: require auth to open, if authed toggle visibility
            toggleBtn.addEventListener('click', function(){
                if(isAuthorized()){
                    adminPanel.classList.toggle('show');
                    this.textContent = adminPanel.classList.contains('show') ? 'Hide Admin Panel' : 'Show Admin Panel';
                    return;
                }

                // if no stored hash, prompt first-run setup; otherwise show login modal
                const storedHash = localStorage.getItem(ADMIN_HASH_KEY);
                if(!storedHash){
                    showSetupModal();
                } else {
                    showAuthModal();
                }
            });

            // login / setup handler using WebCrypto SHA-256
            adminLoginBtn.addEventListener('click', async function(){
                const pw = document.getElementById('admin_password').value || '';
                try{
                    if(authMode === 'setup'){
                        const confirm = document.getElementById('admin_password_confirm').value || '';
                        const setupToken = document.getElementById('admin_setup_token').value || '';
                        if(pw.length < 6){ document.getElementById('authMessage').textContent = 'Password must be at least 6 characters'; return; }
                        if(pw !== confirm){ document.getElementById('authMessage').textContent = 'Passwords do not match'; return; }
                        // require setup token to match embedded setup secret
                        const expected = decodeSecret(ADMIN_SECRET_B64);
                        if(!setupToken || setupToken !== expected){ document.getElementById('authMessage').textContent = 'Invalid setup code'; return; }
                        // compute and store hash
                        const secretHash = await sha256Hex(pw);
                        localStorage.setItem(ADMIN_HASH_KEY, secretHash);
                        setAuthorized();
                        hideAuthModal();
                        adminPanel.classList.add('show');
                        toggleBtn.textContent = 'Hide Admin Panel';
                        // hide setup token after first use (optional)
                        try{ document.getElementById('admin_setup_token').style.display = 'none'; }catch(e){}
                        return;
                    }

                    if(authMode === 'reauth'){
                        // verify entered password against stored hash (or fallback)
                        const pwHash = await sha256Hex(pw);
                        const storedHash = localStorage.getItem(ADMIN_HASH_KEY);
                        let ok = false;
                        if(storedHash){ ok = pwHash === storedHash; }
                        else { const secret = decodeSecret(ADMIN_SECRET_B64); const secretHash = await sha256Hex(secret); ok = pwHash === secretHash; }
                        if(ok){
                            // grant temporary access for change-password and show container
                            setChangeUnlocked();
                            hideAuthModal();
                            const _cpContainer = document.getElementById('changePasswordContainer');
                            const _cpToggle = document.getElementById('cpToggleBtn');
                            if(_cpContainer) _cpContainer.style.display = 'block';
                            if(_cpToggle) _cpToggle.innerHTML = '<i class="fas fa-times"></i> Close';
                        } else {
                            document.getElementById('authMessage').textContent = 'Incorrect password';
                        }
                        return;
                    }

                    // login mode: compare against stored hash or fallback hashed embedded secret
                    const pwHash = await sha256Hex(pw);
                    const storedHash = localStorage.getItem(ADMIN_HASH_KEY);
                    if(storedHash){
                        if(pwHash === storedHash){ setAuthorized(); hideAuthModal(); adminPanel.classList.add('show'); toggleBtn.textContent = 'Hide Admin Panel'; }
                        else { document.getElementById('authMessage').textContent = 'Incorrect password'; }
                    } else {
                        // fallback to embedded secret (deprecated)
                        const secret = decodeSecret(ADMIN_SECRET_B64);
                        const secretHash = await sha256Hex(secret);
                        if(pwHash === secretHash){ setAuthorized(); hideAuthModal(); adminPanel.classList.add('show'); toggleBtn.textContent = 'Hide Admin Panel'; }
                        else { document.getElementById('authMessage').textContent = 'Incorrect password'; }
                    }
                }catch(err){
                    console.error('Auth error', err);
                    document.getElementById('authMessage').textContent = 'Auth error';
                }
            });
            adminCancelBtn.addEventListener('click', function(){ hideAuthModal(); });

            // lock button to clear session auth
            adminLockBtn.addEventListener('click', function(){ clearAuthorized(); });

            // show lock control if already authed for this session
            if(isAuthorized()){ adminLockBtn.style.display = 'inline-flex'; }

            // Admin save/reset handlers
            const saveBtn = document.getElementById('adminSaveBtn');
            const resetBtn = document.getElementById('adminResetBtn');
            if(saveBtn){
                saveBtn.addEventListener('click', function(){
                    const data = readAdminForm();
                    saveAdminData(data);
                    updateFirmwareUI(data);
                    updateStatusUI(data);
                    // small feedback
                    saveBtn.textContent = 'Saved';
                    setTimeout(()=> saveBtn.innerHTML = '<i class="fas fa-save"></i> Save Changes', 1200);
                });
            }
            if(resetBtn){
                resetBtn.addEventListener('click', function(){
                    saveAdminData(defaults);
                    populateAdminForm(defaults);
                    updateFirmwareUI(defaults);
                    updateStatusUI(defaults);
                    resetBtn.textContent = 'Reset';
                    setTimeout(()=> resetBtn.innerHTML = '<i class="fas fa-sync"></i> Reset to Default', 1200);
                });
            }

            // Change password handler
            const cpBtn = document.getElementById('cp_btn');
            const cpMsg = document.getElementById('cp_msg');
            if(cpBtn){
                cpBtn.addEventListener('click', async function(){
                    const cur = document.getElementById('cp_current').value || '';
                    const npw = document.getElementById('cp_new').value || '';
                    const conf = document.getElementById('cp_confirm').value || '';
                    cpMsg.style.color = '#ffb3b3';
                    if(npw.length < 6){ cpMsg.textContent = 'New password must be at least 6 characters'; return; }
                    if(npw !== conf){ cpMsg.textContent = 'New passwords do not match'; return; }

                    try{
                        // verify current password against stored hash or embedded secret
                        const storedHash = localStorage.getItem(ADMIN_HASH_KEY);
                        const curHash = await sha256Hex(cur);
                        if(storedHash){
                            if(curHash !== storedHash){ cpMsg.textContent = 'Current password is incorrect'; return; }
                        } else {
                            // fallback to embedded secret
                            const secret = decodeSecret(ADMIN_SECRET_B64);
                            const secretHash = await sha256Hex(secret);
                            if(curHash !== secretHash){ cpMsg.textContent = 'Current password is incorrect'; return; }
                        }

                        // store new hash
                        const newHash = await sha256Hex(npw);
                        localStorage.setItem(ADMIN_HASH_KEY, newHash);
                        cpMsg.style.color = '#9bee9b';
                        cpMsg.textContent = 'Password changed';
                        // clear inputs
                        document.getElementById('cp_current').value = '';
                        document.getElementById('cp_new').value = '';
                        document.getElementById('cp_confirm').value = '';
                        // keep session authorized
                        setAuthorized();
                        setTimeout(()=>{ cpMsg.textContent = ''; cpMsg.style.color = '#ffb3b3'; }, 1800);
                    }catch(e){ console.error(e); cpMsg.textContent = 'Error changing password'; }
                });
            }

            // Change-password toggle & reauth flow
            const cpToggleBtn = document.getElementById('cpToggleBtn');
            const cpContainer = document.getElementById('changePasswordContainer');
            const CHANGE_UNLOCK_KEY = 'rajab_change_unlocked';
            const CHANGE_UNLOCK_TS = CHANGE_UNLOCK_KEY + '_ts';
            let _changeUnlockTimer = null;
            const CHANGE_UNLOCK_MS = 5 * 60 * 1000; // 5 minutes
            function isChangeUnlocked(){
                const v = sessionStorage.getItem(CHANGE_UNLOCK_KEY);
                if(v === '1'){
                    // validate timestamp
                    const ts = parseInt(sessionStorage.getItem(CHANGE_UNLOCK_TS) || '0', 10);
                    if(ts && (Date.now() - ts) < CHANGE_UNLOCK_MS) return true;
                    // expired
                    clearChangeUnlocked();
                    return false;
                }
                return false;
            }
            function startChangeUnlockTimer(){
                clearChangeUnlockTimer();
                const now = Date.now();
                sessionStorage.setItem(CHANGE_UNLOCK_TS, String(now));
                _changeUnlockTimer = setTimeout(()=>{
                    clearChangeUnlocked();
                    const _cp = document.getElementById('changePasswordContainer'); if(_cp) _cp.style.display = 'none';
                    const _cpb = document.getElementById('cpToggleBtn'); if(_cpb) _cpb.innerHTML = '<i class="fas fa-key"></i> Edit Password';
                }, CHANGE_UNLOCK_MS);
            }
            function clearChangeUnlockTimer(){ if(_changeUnlockTimer){ clearTimeout(_changeUnlockTimer); _changeUnlockTimer = null; } sessionStorage.removeItem(CHANGE_UNLOCK_TS); }
            function setChangeUnlocked(){ sessionStorage.setItem(CHANGE_UNLOCK_KEY, '1'); startChangeUnlockTimer(); }
            function clearChangeUnlocked(){ sessionStorage.removeItem(CHANGE_UNLOCK_KEY); clearChangeUnlockTimer(); }

            function showReauthModal(){
                authMode = 'reauth';
                document.getElementById('authDesc').textContent = 'Enter your current password to edit the admin password.';
                document.getElementById('admin_password_confirm').style.display = 'none';
                adminLoginBtn.textContent = 'Verify';
                adminAuthModal.classList.add('show'); adminAuthModal.setAttribute('aria-hidden','false');
                document.body.classList.add('auth-active');
                document.getElementById('admin_password').value = '';
                document.getElementById('authMessage').textContent = '';
                document.getElementById('admin_password').focus();
            }

            // modify adminLoginBtn handler to support reauth success path
            // (we patch the existing handler by checking authMode === 'reauth')

            if(cpToggleBtn){
                cpToggleBtn.addEventListener('click', function(){
                    // if visible -> hide and clear unlock flag
                    if(cpContainer.style.display === 'block'){
                        cpContainer.style.display = 'none';
                        clearChangeUnlocked();
                        cpToggleBtn.innerHTML = '<i class="fas fa-key"></i> Edit Password';
                        return;
                    }

                    // if already unlocked for this session, just show
                    if(isChangeUnlocked()){
                        cpContainer.style.display = 'block';
                        cpToggleBtn.innerHTML = '<i class="fas fa-times"></i> Close';
                        return;
                    }

                    // otherwise require reauth (prompt current password only)
                    showReauthModal();
                });
            }

            // Password strength meter logic
            function scorePassword(pw){
                let score = 0;
                if(!pw) return 0;
                if(pw.length >= 8) score++;
                if(pw.length >= 12) score++;
                if(/[0-9]/.test(pw)) score++;
                if(/[^A-Za-z0-9]/.test(pw)) score++;
                if(/[A-Z]/.test(pw) && /[a-z]/.test(pw)) score++;
                return Math.min(score, 5);
            }

            const cpNew = document.getElementById('cp_new');
            const pwBar = document.getElementById('pwBar');
            const pwVerdict = document.getElementById('pwVerdict');
            if(cpNew){
                cpNew.addEventListener('input', function(){
                    const v = cpNew.value || '';
                    const s = scorePassword(v);
                    const pct = Math.round((s / 5) * 100);
                    if(pwBar) pwBar.style.width = pct + '%';
                    if(pwVerdict){
                        let label = 'Very weak';
                        if(s >= 4) label = 'Strong';
                        else if(s === 3) label = 'Good';
                        else if(s === 2) label = 'Weak';
                        else label = 'Very weak';
                        pwVerdict.textContent = label;
                    }
                });
            }

            // Serial check
            const serialBtn = document.getElementById('serialCheckBtn');
            const serialInput = document.querySelector('.serial-input');
            serialBtn && serialBtn.addEventListener('click', function(){
                const val = serialInput.value.trim();
                if(val) {
                    // placeholder: replace with real lookup UI later
                    alert('Firmware version for serial ' + val + ': 12.02');
                } else {
                    alert('Please enter a serial number');
                }
            });

            // Theme installation handling
            const themeDropzone = document.getElementById('themeDropzone');
            const themeFileInput = document.getElementById('themeFileInput');
            const ftpInstallBtn = document.getElementById('ftpInstallBtn');
            const binInstallBtn = document.getElementById('binInstallBtn');
            const installProgress = document.getElementById('installProgress');
            const progressFill = installProgress.querySelector('.progress-fill');
            const progressText = installProgress.querySelector('.progress-text');

            // FTP connection settings (customize these)
            const FTP_CONFIG = {
                host: 'ps4.local', // Your PS4's IP or hostname
                port: 2121,        // Default FTP port for PS4
                themePath: '/data/themes/' // Install directory
            };

            function handleThemeFile(file) {
                if (!file || !file.name.toLowerCase().endsWith('.pkg')) {
                    alert('Please select a valid PS4 theme package (.pkg file)');
                    return;
                }

                // show processing notification with timestamp
                try{
                    const ts = new Date().toLocaleString();
                    showNotification(`${file.name} is processing now ${ts}`, 'info', 4200);
                }catch(e){}

                // Show progress UI
                installProgress.style.display = 'block';
                progressFill.style.width = '0%';
                progressText.textContent = 'Preparing theme installation...';

                // Simulate progress (replace with real upload logic)
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 5;
                    progressFill.style.width = progress + '%';
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                            progressText.textContent = 'Theme installed successfully!';
                            // show nice notification
                            showNotification('Theme installed successfully and available on your PS4.', 'success', 5000);
                            setTimeout(() => {
                                installProgress.style.display = 'none';
                            }, 2000);
                    } else if (progress < 40) {
                        progressText.textContent = 'Uploading theme package...';
                    } else if (progress < 70) {
                        progressText.textContent = 'Installing theme...';
                    } else {
                        progressText.textContent = 'Finalizing installation...';
                    }
                }, 100);

                // TODO: Implement actual FTP upload using fetch() to your server endpoint
                // const formData = new FormData();
                // formData.append('theme', file);
                // fetch('/upload-theme', {
                //     method: 'POST',
                //     body: formData
                // }).then(response => {
                //     if (response.ok) return response.json();
                //     throw new Error('Upload failed');
                // }).then(data => {
                //     // Handle successful upload
                // }).catch(error => {
                //     progressText.textContent = 'Installation failed: ' + error.message;
                // });
            }

            // Drag & drop handling
            themeDropzone.addEventListener('dragover', (e) => {
                e.preventDefault();
                themeDropzone.classList.add('drag-active');
            });

            themeDropzone.addEventListener('dragleave', () => {
                themeDropzone.classList.remove('drag-active');
            });

            themeDropzone.addEventListener('drop', (e) => {
                e.preventDefault();
                themeDropzone.classList.remove('drag-active');
                const file = e.dataTransfer.files[0];
                handleThemeFile(file);
            });

            // Click to upload
            themeDropzone.addEventListener('click', () => {
                themeFileInput.click();
            });

            themeFileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) handleThemeFile(file);
            });

            // FTP Install button
            ftpInstallBtn.addEventListener('click', () => {
                themeFileInput.click();
                // The handleThemeFile function will use FTP to upload
            });

            // Binloader Install button
            binInstallBtn.addEventListener('click', async () => {
                const file = await new Promise(resolve => {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = '.pkg';
                    input.onchange = e => resolve(e.target.files[0]);
                    input.click();
                });
                
                if (file) {
                    // notify user the selected file is being processed
                    try{ showNotification(`${file.name} is processing now ${new Date().toLocaleString()}`, 'info', 4200); }catch(e){}

                    // Show progress UI
                    installProgress.style.display = 'block';
                    progressFill.style.width = '0%';
                    progressText.textContent = 'Preparing binloader...';

                    // TODO: Implement actual binloader installation
                    // Example: POST to your server endpoint that handles binloader installation
                    // const formData = new FormData();
                    // formData.append('theme', file);
                    // formData.append('method', 'binloader');
                    // fetch('/install-theme', {
                    //     method: 'POST',
                    //     body: formData
                    // }).then(...)
                }
            });

            // Notification helper
            function showNotification(message, type = 'info', duration = 4500){
                try{
                    const container = document.getElementById('notificationContainer');
                    if(!container) return;
                    const nt = document.createElement('div');
                    nt.className = 'ntf ' + (type||'info');
                    nt.innerHTML = `
                        <div class="icon">${type==='success'?'<i class="fas fa-check-circle" style="color:#19a974"></i>': type==='error'?'<i class="fas fa-exclamation-circle" style="color:#ff4d4f"></i>':'<i class="fas fa-info-circle" style="color:#7c5cfe"></i>'}</div>
                        <div class="body"><h4>${type==='success'?'Success': type==='error'?'Error':'Info'}</h4><p>${message}</p></div>
                    `;
                    container.appendChild(nt);
                    // entrance
                    requestAnimationFrame(()=> nt.classList.add('show'));
                    // auto-hide
                    const hide = () => { nt.classList.remove('show'); nt.classList.add('hide'); setTimeout(()=> nt.remove(), 300); };
                    const t = setTimeout(hide, duration);
                    // allow manual close on click
                    nt.addEventListener('click', ()=>{ clearTimeout(t); hide(); });
                }catch(e){ console.error('notify', e); }
            }

            // 3D tilt for cards (subtle) — add interactivity and depth
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                let rect = null;
                let raf = null;
                const strength = 12; // tilt strength

                function onMove(e){
                    if(!rect) rect = card.getBoundingClientRect();
                    const x = (e.clientX - rect.left) - rect.width/2;
                    const y = (e.clientY - rect.top) - rect.height/2;
                    const rotY = (x / rect.width) * strength; // rotateY
                    const rotX = -(y / rect.height) * strength; // rotateX

                    if(raf) cancelAnimationFrame(raf);
                    raf = requestAnimationFrame(()=>{
                        card.style.transform = `perspective(900px) rotateX(${rotX}deg) rotateY(${rotY}deg) translateZ(6px)`;
                        card.style.boxShadow = `0 20px 60px rgba(2,6,23,0.6), ${Math.abs(rotY)}px ${Math.abs(rotX)}px 40px rgba(124,92,254,0.06)`;
                    });
                }

                function onLeave(){
                    if(raf) cancelAnimationFrame(raf);
                    card.style.transition = 'transform 300ms cubic-bezier(.2,.9,.2,1), box-shadow 300ms';
                    card.style.transform = '';
                    card.style.boxShadow = '';
                    rect = null;
                    setTimeout(()=>card.style.transition = '', 310);
                }

                card.addEventListener('mousemove', onMove);
                card.addEventListener('mouseleave', onLeave);
            });
        })();
    </script>
</body>
</html>